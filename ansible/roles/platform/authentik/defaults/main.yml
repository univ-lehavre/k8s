---
# Authentik IAM defaults

# Namespace
authentik_namespace: authentik

# Helm chart settings
authentik_chart_repo: https://charts.goauthentik.io
authentik_chart_repo_name: goauthentik

# Replicas
authentik_server_replicas: "{{ 2 if ha_enabled else 1 }}"
authentik_worker_replicas: "{{ 2 if ha_enabled else 1 }}"

# Resources
authentik_server_resources:
  requests:
    cpu: 100m
    memory: 512Mi
  limits:
    cpu: 500m
    memory: 1Gi

authentik_worker_resources:
  requests:
    cpu: 50m
    memory: 256Mi
  limits:
    cpu: 200m
    memory: 512Mi

# Secrets from CI/CD
authentik_secret_key: "{{ secrets.authentik.secret_key | default(omit) }}"
authentik_admin_password: "{{ secrets.authentik.admin_password | default(omit) }}"
authentik_admin_token: "{{ secrets.authentik.admin_token | default(omit) }}"

# Database settings
authentik_postgresql_host: "postgresql.postgresql.svc.cluster.local"
authentik_postgresql_port: 5432
authentik_postgresql_database: "{{ database_config.authentik.database }}"
authentik_postgresql_user: "{{ database_config.authentik.user }}"

# Redis settings
authentik_redis_host: "redis-master.redis.svc.cluster.local"
authentik_redis_port: 6379

# Ingress settings
authentik_ingress_enabled: true
authentik_ingress_host: "auth.{{ domain }}"
authentik_ingress_class: cilium
authentik_ingress_tls_secret: authentik-tls
authentik_ingress_issuer: "{{ tls_issuer }}"

# Admin user
authentik_admin_email: "admin@{{ domain }}"

# Log level
authentik_log_level: info

# Error reporting
authentik_error_reporting_enabled: false

# OIDC providers to configure
authentik_oidc_providers: []
#  - name: mattermost
#    client_id: mattermost
#    redirect_uris:
#      - https://chat.{{ domain }}/signup/gitlab/complete
#    groups:
#      - mattermost-users
