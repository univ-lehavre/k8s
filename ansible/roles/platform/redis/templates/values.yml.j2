# Redis Helm Values
# Generated by Ansible

architecture: {{ redis_architecture }}

auth:
  enabled: true
  existingSecret: redis-credentials
  existingSecretPasswordKey: redis-password

master:
  resources:
    requests:
      cpu: {{ redis_resources.requests.cpu }}
      memory: {{ redis_resources.requests.memory }}
    limits:
      cpu: {{ redis_resources.limits.cpu }}
      memory: {{ redis_resources.limits.memory }}

  persistence:
    enabled: true
    storageClass: {{ redis_storage_class }}
    size: {{ redis_storage_size }}

{% if redis_architecture == 'replication' %}
replica:
  replicaCount: {{ redis_replicas | int - 1 }}

  resources:
    requests:
      cpu: {{ redis_resources.requests.cpu }}
      memory: {{ redis_resources.requests.memory }}
    limits:
      cpu: {{ redis_resources.limits.cpu }}
      memory: {{ redis_resources.limits.memory }}

  persistence:
    enabled: true
    storageClass: {{ redis_storage_class }}
    size: {{ redis_storage_size }}
{% endif %}

{% if redis_sentinel_enabled %}
sentinel:
  enabled: true
  quorum: 2

  resources:
    requests:
      cpu: {{ redis_sentinel_resources.requests.cpu }}
      memory: {{ redis_sentinel_resources.requests.memory }}
    limits:
      cpu: {{ redis_sentinel_resources.limits.cpu }}
      memory: {{ redis_sentinel_resources.limits.memory }}
{% endif %}

metrics:
  enabled: {{ redis_metrics_enabled | lower }}
  serviceMonitor:
    enabled: {{ redis_metrics_enabled | lower }}

# Pod Disruption Budget
pdb:
  create: {{ ha_enabled | default(false) | lower }}
  minAvailable: 1

# Network policy
networkPolicy:
  enabled: false
