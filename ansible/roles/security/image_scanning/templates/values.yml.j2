# Trivy Operator Helm Values
# Generated by Ansible

trivy:
  # Vulnerability scanning
  ignoreUnfixed: {{ trivy_ignore_unfixed | lower }}
  severity: {{ trivy_severity_threshold }}
  timeout: {{ trivy_scan_job_timeout }}

  # Scan types
  scanVulnerabilities: {{ trivy_scan_vulnerabilities | lower }}
  scanMisconfigurations: {{ trivy_scan_misconfigurations | lower }}
  scanSecrets: {{ trivy_scan_exposed_secrets | lower }}
  scanRbacAssessment: {{ trivy_scan_rbac_assessment | lower }}

  resources:
    requests:
      cpu: {{ trivy_scanner_resources.requests.cpu }}
      memory: {{ trivy_scanner_resources.requests.memory }}
    limits:
      cpu: {{ trivy_scanner_resources.limits.cpu }}
      memory: {{ trivy_scanner_resources.limits.memory }}

operator:
  # Concurrent scans
  scanJobsConcurrentLimit: {{ trivy_concurrent_scan_jobs }}

  # Metrics
  metricsVulnIdEnabled: true

  resources:
    requests:
      cpu: {{ trivy_operator_resources.requests.cpu }}
      memory: {{ trivy_operator_resources.requests.memory }}
    limits:
      cpu: {{ trivy_operator_resources.limits.cpu }}
      memory: {{ trivy_operator_resources.limits.memory }}

# Service Monitor for Prometheus
serviceMonitor:
  enabled: {{ monitoring_enabled | default(true) | lower }}

{% if trivy_private_registry_enabled %}
# Private registry authentication
imagePullSecret:
  name: trivy-registry-credentials
  registry: {{ trivy_private_registry_server }}
  username: {{ trivy_private_registry_username }}
  password: {{ trivy_private_registry_password }}
{% endif %}

# Compliance
compliance:
  cron: "{{ trivy_scan_schedule }}"
