---
# Mapping of CI/CD environment variables to Ansible variables
# All secrets should be provided via environment variables in CI/CD
# DO NOT store actual secrets in this file

secrets:
  # K3s cluster token
  k3s:
    token: "{{ lookup('env', 'K3S_TOKEN') | default(omit) }}"

  # Vault secrets
  vault:
    root_token: "{{ lookup('env', 'VAULT_ROOT_TOKEN') | default(omit) }}"
    unseal_keys: "{{ lookup('env', 'VAULT_UNSEAL_KEYS') | default('[]') | from_json }}"

  # Database credentials
  postgresql:
    superuser_password: "{{ lookup('env', 'POSTGRES_SUPERUSER_PASSWORD') | default(omit) }}"
    replication_password: "{{ lookup('env', 'POSTGRES_REPLICATION_PASSWORD') | default(omit) }}"

  redis:
    password: "{{ lookup('env', 'REDIS_PASSWORD') | default(omit) }}"

  # Service credentials
  authentik:
    secret_key: "{{ lookup('env', 'AUTHENTIK_SECRET_KEY') | default(omit) }}"
    admin_password: "{{ lookup('env', 'AUTHENTIK_ADMIN_PASSWORD') | default(omit) }}"
    admin_token: "{{ lookup('env', 'AUTHENTIK_ADMIN_TOKEN') | default(omit) }}"

  mattermost:
    admin_password: "{{ lookup('env', 'MATTERMOST_ADMIN_PASSWORD') | default(omit) }}"

  nextcloud:
    admin_password: "{{ lookup('env', 'NEXTCLOUD_ADMIN_PASSWORD') | default(omit) }}"

  gitea:
    admin_password: "{{ lookup('env', 'GITEA_ADMIN_PASSWORD') | default(omit) }}"

  argocd:
    admin_password: "{{ lookup('env', 'ARGOCD_ADMIN_PASSWORD') | default(omit) }}"

  grafana:
    admin_password: "{{ lookup('env', 'GRAFANA_ADMIN_PASSWORD') | default(omit) }}"

  redcap:
    salt: "{{ lookup('env', 'REDCAP_SALT') | default(omit) }}"

  flipt:
    # Flipt uses database auth, no additional secrets needed

  seaweedfs:
    s3_access_key: "{{ lookup('env', 'SEAWEEDFS_S3_ACCESS_KEY') | default(omit) }}"
    s3_secret_key: "{{ lookup('env', 'SEAWEEDFS_S3_SECRET_KEY') | default(omit) }}"

  onlyoffice:
    jwt_secret: "{{ lookup('env', 'ONLYOFFICE_JWT_SECRET') | default(omit) }}"

  # TLS/Let's Encrypt
  letsencrypt:
    email: "{{ lookup('env', 'LETSENCRYPT_EMAIL') | default('admin@example.com') }}"

  # Longhorn encryption
  longhorn:
    crypto_key: "{{ lookup('env', 'LONGHORN_CRYPTO_KEY') | default(omit) }}"

  # etcd encryption
  etcd:
    encryption_key: "{{ lookup('env', 'ETCD_ENCRYPTION_KEY') | default(omit) }}"

# Database names and users mapping
database_config:
  vault:
    database: vault
    user: vault_user
  authentik:
    database: authentik
    user: authentik_user
  mattermost:
    database: mattermost
    user: mattermost_user
  nextcloud:
    database: nextcloud
    user: nextcloud_user
  gitea:
    database: gitea
    user: gitea_user
  redcap:
    database: redcap
    user: redcap_user
  flipt:
    database: flipt
    user: flipt_user
