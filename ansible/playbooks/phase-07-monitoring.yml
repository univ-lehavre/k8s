# Phase 7: Monitoring

- name: Phase 7 - Monitoring Stack
  hosts: localhost
  gather_facts: false
  vars_files:
    - ../vars/versions.yml
    - ../vars/secrets_mapping.yml

  roles:
    - role: monitoring/kube_prometheus
      tags: [monitoring, prometheus, grafana, alertmanager]
    - role: monitoring/hubble_ui
      tags: [monitoring, hubble, cilium, network]
    - role: monitoring/loki
      tags: [monitoring, loki, alloy, logging]

  post_tasks:
    - name: Phase 7 complete
      ansible.builtin.debug:
        msg: |
          Monitoring deployed:
          - Grafana: https://grafana.{{ domain }}
          - Hubble UI: https://hubble.{{ domain }}
          - Loki: Log aggregation in Grafana

          Default Grafana credentials: admin / (see secrets)
