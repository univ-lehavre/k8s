# ATLAS Platform - Environment Variables
# Copy this file to .env and configure with your values
# Usage: source .env && ansible-playbook ...

# =============================================================================
# REQUIRED - All Environments
# =============================================================================

# K3s cluster token (generate with: openssl rand -hex 32)
export K3S_TOKEN="your-secure-cluster-token"

# PostgreSQL superuser password (generate with: openssl rand -base64 24)
export POSTGRES_SUPERUSER_PASSWORD="your-postgres-password"

# PostgreSQL replication password (for HA)
export POSTGRES_REPLICATION_PASSWORD="your-replication-password"

# Redis password
export REDIS_PASSWORD="your-redis-password"


# =============================================================================
# REQUIRED - Production Only
# =============================================================================

# Domain for production services
export PROD_DOMAIN="atlas.example.com"

# Admin IP range for K3s API access (CIDR format)
# WARNING: This is mandatory in production - no default allowed
export ADMIN_IP="203.0.113.0/24"

# Let's Encrypt email for TLS certificates
export LETSENCRYPT_EMAIL="admin@example.com"

# Production server IPs
export PROD_MASTER_HOST="10.0.2.10"
export PROD_WORKER1_HOST="10.0.2.11"
export PROD_WORKER2_HOST="10.0.2.12"
export PROD_WORKER3_HOST="10.0.2.13"

# SSH key for server access
export PROD_SSH_KEY="~/.ssh/production_key"

# =============================================================================
# STAGING SERVER
# =============================================================================

# Staging server IP
export STAGING_DOMAIN="staging.example.com"
export STAGING_HOST="10.0.1.10"
export STAGING_SSH_KEY="~/.ssh/staging_key"

# =============================================================================
# ENCRYPTION KEYS
# =============================================================================

# Longhorn storage encryption key (generate with: openssl rand -base64 32)
export LONGHORN_CRYPTO_KEY="your-longhorn-encryption-key"

# etcd encryption key (generate with: openssl rand -base64 32)
export ETCD_ENCRYPTION_KEY="your-etcd-encryption-key"

# =============================================================================
# VAULT (Post-initialization)
# =============================================================================

# After Vault initialization, set these from the output
export VAULT_ROOT_TOKEN=""
export VAULT_UNSEAL_KEYS='["key1", "key2", "key3"]'

# =============================================================================
# SERVICE ADMIN PASSWORDS
# =============================================================================

export MATTERMOST_ADMIN_PASSWORD="your-mattermost-admin-password"
export NEXTCLOUD_ADMIN_PASSWORD="your-nextcloud-admin-password"
export GITEA_ADMIN_PASSWORD="your-gitea-admin-password"
export ARGOCD_ADMIN_PASSWORD="your-argocd-admin-password"
export GRAFANA_ADMIN_PASSWORD="your-grafana-admin-password"

# =============================================================================
# OPTIONAL - Per-Service Database Passwords
# =============================================================================
# If not set, falls back to POSTGRES_SUPERUSER_PASSWORD

# export VAULT_DB_PASSWORD=""
# export KEYCLOAK_DB_PASSWORD=""
# export MATTERMOST_DB_PASSWORD=""
# export NEXTCLOUD_DB_PASSWORD=""
# export GITEA_DB_PASSWORD=""
# export REDCAP_DB_PASSWORD=""
# export FLIPT_DB_PASSWORD=""

# =============================================================================
# OPTIONAL - Additional Services
# =============================================================================

# ECRIN - REDCap integration
# export ECRIN_REDCAP_URL="https://redcap.example.com/api/"
# export ECRIN_REDCAP_TOKEN="your-redcap-api-token"

# REDCap salt (for password hashing)
export REDCAP_SALT="your-redcap-salt"

# SeaweedFS S3 credentials
export SEAWEEDFS_S3_ACCESS_KEY="your-s3-access-key"
export SEAWEEDFS_S3_SECRET_KEY="your-s3-secret-key"

# OnlyOffice JWT secret
export ONLYOFFICE_JWT_SECRET="your-onlyoffice-jwt-secret"

# =============================================================================
# VAULT AUTO-UNSEAL (Production recommended)
# =============================================================================

# Enable auto-unseal (recommended for production)
# export VAULT_AUTO_UNSEAL_ENABLED="true"
# export VAULT_AUTO_UNSEAL_TYPE="awskms"  # awskms, gcpkms, or azurekeyvault

# AWS KMS settings
# export AWS_REGION="eu-west-1"
# export VAULT_AWSKMS_KEY_ID="your-kms-key-id"

# GCP KMS settings
# export GCP_PROJECT="your-project"
# export GCP_REGION="europe-west1"
# export VAULT_GCPKMS_KEY_RING="vault"
# export VAULT_GCPKMS_CRYPTO_KEY="unseal"

# Azure Key Vault settings
# export VAULT_AZURE_VAULT_NAME="your-vault-name"
# export VAULT_AZURE_KEY_NAME="unseal-key"

# =============================================================================
# OFF-SITE BACKUP (Production recommended)
# =============================================================================

# S3-compatible storage for off-site backups
# export BACKUP_S3_ENDPOINT="s3.amazonaws.com"
# export BACKUP_S3_BUCKET="atlas-backups"
# export BACKUP_S3_REGION="eu-west-1"
# export BACKUP_S3_ACCESS_KEY="your-access-key"
# export BACKUP_S3_SECRET_KEY="your-secret-key"

# Backup encryption key (generate with: openssl rand -base64 32)
# export BACKUP_ENCRYPTION_KEY="your-encryption-key"

# =============================================================================
# SMTP (Email delivery via Brevo or other provider)
# =============================================================================

# SMTP relay settings (used by Keycloak, Mattermost, Nextcloud, Gitea)
# export SMTP_HOST="smtp-relay.brevo.com"
# export SMTP_PORT="587"
# export SMTP_USER="your-brevo-login@example.com"
# export SMTP_PASSWORD="your-brevo-smtp-key"
# export SMTP_FROM="noreply@example.com"

# =============================================================================
# AUDIT LOG FORWARDING (Optional - for SIEM integration)
# =============================================================================

# Forward audit logs to a central SIEM
# export AUDIT_FORWARD_HOST="siem.example.com"
# export AUDIT_FORWARD_PORT="514"

# =============================================================================
# GITEA ADMIN USER (Optional)
# =============================================================================

# Custom Gitea admin username (defaults to gitea_admin)
# export GITEA_ADMIN_USER="custom_admin"
